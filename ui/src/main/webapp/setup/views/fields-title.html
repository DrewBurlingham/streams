<!-- STEP 4 -->
<layout:grid>
    <layout:block lg="1-2" lg-offset="1-4">
        <layout:box>

            <div class="barspinner" ng-show="status.working">
              <div class="rect1"></div>
              <div class="rect2"></div>
              <div class="rect3"></div>
              <div class="rect4"></div>
              <div class="rect5"></div>
              <h3>analyzing data...</h3>
            </div>

            <div ng-show="!status.working">
                <legend><a ng-disabled="$isFirst()" ng-click="$previousStep()" class="link-secondary">Go back</a>Set Result Title</legend>

                <fieldset>
                    <div class="conf">
                        <label for="fields" class="forinput">Field</label>
                        <!-- select -->
                        <div styling="labelled-input">
                            <select name="fields" ng-model="view.results.title_field" ng-options="key as key for (key , value) in insights.fields" styling="input-1"></select><br>
                        </div>
                        <div class="sample showblock">
                            <h5>Sample values returned for this field:</h5>
                            <ol>
                                <li ng-repeat="s in insights.fields[view.results.title_field].sample | limitTo: 3">{{s | limitTo: 50}}...</li>
                            </ol>
                        </div>

                        <!--  suggestions  -->
                        <p class="standout" ng-show="insights.title_suggestions.length > 0">suggested fields:</p>
                        <layout:grid>
                            <layout:block>
                                <label ng-repeat="title_field in insights.title_suggestions" ng-init="view.results.title_field = insights.title_suggestions[0]" class="forcelc">
                                    <input type="radio" name="title_fields" ng-model="view.results.title_field" ng-value="title_field" ng-checked="$index==0" />{{title_field}} 
                                    <i class="samplematch">({{insights.fields[title_field].cardinality * 100 | number: 0}}% of results have values)</i><br/>
                                </label>
                            </layout:block>
                        </layout:grid>
                            
                    </div>
                </fieldset>

                <fieldset>
                  <div class="conf">
                        <label for="fields" class="forinput">Target URL</label>
                        <!-- select -->
                        <div styling="labelled-input">
                            <select name="url_fields" ng-options="key as key for (key , value) in insights.fields" ng-model="view.results.url_field" styling="input-1"></select><br>
                        </div>
                        <!--  suggestions  -->
                        <p class="standout" ng-show="insights.url_fields.length > 0">suggested fields:</p>
                        
                        <layout:grid>
                            <layout:block>
                                <label ng-repeat="url_field in insights.url_fields" ng-init="view.results.url_field = insights.url_fields[0]" class="forcelc">
                                    <input type="radio" name="url_fields" ng-model="view.results.url_field" ng-value="url_field" ng-checked="$index==0" />{{url_field}} 

                                    <i class="samplematch">({{insights.fields[url_field].cardinality * 100 | number: 0}}% of results have values)</i><br/>
                                </label>
                            </layout:block>
                        </layout:grid>

                    </div>
                </fieldset>

                <button type="button" styling="button input-1" ng-click="$nextStep();" ng-class="configureClass">{{configureText}}</button>
            </div>

        </layout:box>
    </layout:block>
</layout:grid>